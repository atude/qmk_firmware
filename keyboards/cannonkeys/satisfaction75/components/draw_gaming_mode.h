#pragma once

#include "satisfaction75.h"
#include "draw.h"
#include "helpers.h"
#include "atyu.h"
#include <stdio.h>

#ifdef OLED_GAMING_MODE_ENABLED

const char PROGMEM outline[DEFAULT_ANIM_SIZE] = { // 'pixil-frame-0 (2)', 128x32px
    // 'pixil-frame-0 (3)', 128x32px
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0xa0, 0x10, 0x08, 0x04, 0x02, 0x01, 0x02, 0x04, 0x08, 0x10, 0xa0, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x08, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x08, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0xa0, 0x11, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x11, 0xa0, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x08, 0x08, 0x10, 0x20, 0x20, 0x20, 0x20, 0x10, 0x08, 0x08, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x08, 0x04, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

void draw_gaming_mode(bool show_enc_turn) {
    led_t   led_state = host_keyboard_led_state();
    uint8_t mod_state = get_mods();

    oled_write_raw_P(outline, DEFAULT_ANIM_SIZE);

    for (uint8_t x = 0; x < MATRIX_ROWS; x++) {
        for (uint8_t y = 0; y < MATRIX_COLS; y++) {
            bool on = (matrix_get_row(x) & (1 << y)) > 0;

            if (on) {
                if (matrix_is_on(2, 2)) { // w
                    draw_rectangle(17, 10, 4, 8, true);
                    draw_line_v(16, 11, 9, true);
                    draw_line_v(21, 11, 9, true);
                    draw_pixel(17, 18, true);
                    draw_pixel(20, 18, true);
                }
                if (matrix_is_on(3, 1)) { // a
                    draw_line_h(8, 20, 8);
                    draw_line_h(7, 21, 8);
                    draw_rectangle(7, 22, 7, 3, true);
                }
                if (matrix_is_on(3, 2)) { // s
                    draw_line_h(18, 19, 2);
                    draw_line_h(17, 20, 4);
                    draw_line_h(16, 21, 6);
                    draw_rectangle(15, 22, 8, 4, true);
                    draw_line_h(17, 26, 4);
                    draw_line_h(18, 27, 2);
                }
                if (matrix_is_on(3, 3)) { // d
                    draw_line_h(22, 20, 8);
                    draw_line_h(23, 21, 8);
                    draw_rectangle(24, 22, 7, 3, true);
                }
                if (matrix_is_on(5, 5)) { // space
                    draw_line_h(42, 16, 7);
                    draw_line_h(41, 15, 9);
                    draw_line_h(40, 14, 11);
                    draw_line_h(41, 13, 9);
                    draw_line_h(42, 12, 7);
                    draw_line_h(43, 11, 5);
                    draw_line_h(44, 10, 3);
                    draw_line_h(45, 9, 1);
                }
                if (matrix_is_on(0, 2)) { // tab
                    // draw_line_h(42, 16, 7);
                    // draw_line_h(41, 15, 9);
                    // draw_line_h(40, 14, 11);
                    // draw_line_h(41, 13, 9);
                    // draw_line_h(42, 12, 7);
                    // draw_line_h(43, 11, 5);
                    // draw_line_h(44, 10, 3);
                    // draw_line_h(45, 9, 1);
                }
            }
        }
    }

    if (mod_state & MOD_MASK_CTRL) {
        draw_line_h(42, 20, 7);
        draw_line_h(41, 21, 9);
        draw_line_h(40, 22, 11);
        draw_line_h(41, 23, 9);
        draw_line_h(42, 24, 7);
        draw_line_h(43, 25, 5);
        draw_line_h(44, 26, 3);
        draw_line_h(45, 27, 1);
    }
    if (mod_state & MOD_MASK_SHIFT) {
        draw_pixel(6, 10, true);
        draw_pixel(7, 9, true);
        draw_pixel(8, 8, true);
        draw_pixel(9, 9, true);
        draw_pixel(10, 10, true);

        draw_pixel(6, 13, true);
        draw_pixel(7, 12, true);
        draw_pixel(8, 11, true);
        draw_pixel(9, 12, true);
        draw_pixel(10, 13, true);
    } else if (tab_pressed) {
        draw_rectangle_outline(5, 8, 7, 7);
        draw_line_h(7, 10, 3);
        draw_line_h(7, 12, 3);
    }

    draw_mods_square(mod_state, enc_turn_state, show_enc_turn, 10, 1);
    switch (date_time_mode) {
        default:
        case 0:
            oled_set_cursor(is_24hr_time() ? 16 : 14, 1);
            oled_write(get_time(), false);
            break;
        case 1:
            oled_set_cursor(13, 1);
            oled_write(get_date(false), false);
            break;
        case 2:
            oled_set_cursor(18, 1);
            if (wpm() > 0) {
                oled_write(get_u8_str(wpm(), '0'), false);
            } else {
                oled_write_P(PSTR("WPM"), false);
            }
            break;
    }
    draw_info_panel(led_state, layer_state, get_enc_mode(), 10, 3, true);
};

#endif
